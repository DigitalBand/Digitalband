@(productListPage: models.ListPage[models.ProductEntity], currentCategory: CategoryEntity,
categories: Seq[models.CategoryListItem], brands: ListPage[models.BrandEntity], brand:Option[models.BrandEntity],
pageNumber: Int, pageSize: Int, breadcrumbItems:Seq[(Int, String)] = List(), searchQuery:String)
@import helpers.ViewHelper._
@import Shared._

@main(Messages("product.list.title"), "catalogue", search = searchQuery) {
    <div class="row">
        <div class="span3">
            @sidebar(categories, brands, currentCategory.id, brandId(brand), searchQuery)
        </div>
        <div class="span9">
            @breadcrumbs(breadcrumbItems,
                categoryId => routes.Product.filteredList(categoryId, 1, brandId(brand), s = searchQuery))
            <h4>
                @currentCategory.title<br/>
                <small>
                    @searchQuery match {
                        case s if s.isEmpty => {}
                        case s => {
                            <i>@Messages("product.list.pagesubtitle")</i> @s
                        }
                    }
                </small>
            </h4>
            @brand match {
                case Some(b) => {
                    <div>
                            @if(b.imageId > 0){
                            <a class="img-link pull-right" href="@routes.Product.filteredList(currentCategory.id, 1)">
                                <img alt="@b.title" src="@routes.Image.get(b.imageId + ".jpg", 100, "60x50", "full")" />
                            </a>
                            } else {
                                <a href="@routes.Product.filteredList(currentCategory.id, 1)">@b.title</a>
                            }
                    </div>
                }
                case None => {}
            }
            @pager(helpers.PagerHelper(pageSize, productListPage.totalCount, productListPage.number),
                pn => routes.Product.filteredList(currentCategory.id, pn, brandId(brand), s = searchQuery))
            <div class="product-list">
                @productListPage.items.map { product =>
                    <div class="row">
                        <div class="span2">
                            <a href="@routes.Product.filteredList(currentCategory.id, pageNumber, brandId(brand),
                                productId = product.id, s = searchQuery)">
                                <img alt="" id="tmp" src="@routes.Image.get(product.defaultImageId + ".jpg", 90, "170x170", "full")">
                            </a>
                        </div>
                        <div class="span5">
                            <a href="@routes.Product.filteredList(currentCategory.id, pageNumber, brandId(brand),
                                productId = product.id, s = searchQuery)">
                                <h5>@product.title</h5>
                            </a>
                            <p>@product.description&nbsp;</p>
                        </div>
                        <div class="span2">
                            <h4>
                            @{product.price match {case d:Double if d == 0.0 => Messages("global.productItem.noprice") case e => e + " Ñ€."}}
                            </h4>
                        </div>
                        <div class="span2">
                            @addToCartButton()
                        </div>
                    </div>
                    <hr />
                }
                @pager(helpers.PagerHelper(pageSize, productListPage.totalCount, productListPage.number),
                    pn => routes.Product.filteredList(currentCategory.id, pn, brandId(brand)))
            </div>
        </div>
    </div>
}